{% extends 'front-end/app.twig' %}

{% block title %}Cart - MIT Book Store{% endblock %}

{% block content %}
	<section class="content">
		{% include 'templates/partials/flash.twig'%}
		<div class="row">
			<div class="col-md-8">
				{% if basket.itemCount %}
					<div class="well">
						<table class="table">
							<thead>
								<tr>
									<th>Image</th>
									<th>Title</th>
									<th>Price</th>
									<th>Quantity</th>
									<td></td>
								</tr>
							</thead>
							<tbody>
								{% for item in basket.all %}
									<tr>
										<td><img src="{{base_url()}}/upload/{{item.images}}" alt="{{item.title}}" width="100px" height="150px"/></td>
										<td><a href="{{path_for('book.slug', {slug:item.slug})}}">{{item.title}}</a></td>
										<td>{{item.price | number_format}} IDR</td>
										<form action="{{path_for('cart.update', { slug : item.slug })}}" method="POST">
											<td>
												<button name="update" class="btn btn-default" value="-1">
													-
												</button>
												{{item.qty}}
												{% if not basket.checkStock(item.id) %}
													<button name="update" class="btn btn-default" value="1">
														+
													</button>
												{% else %}
												    <button type="button" class="btn btn-default" disabled title="Maximum Stock">
														+
													</button>
												{% endif %}
												
											</td>
											<td class="pull-right">
												<button name="update" class="btn btn-danger" value="0" title="Remove">X</button>
											</td>
											{{csrf.field | raw}}
										</form>
									</tr>
								{% endfor %}
							</tbody>
						</table>
					</div>
				{% else %}
					<p>You have no items in your cart. <a href="{{path_for('home')}}">Start Shopping</a></p>	    
				{% endif %}
			</div>
			<div class="col-md-4">
				{% if basket.itemCount and basket.subTotal %}
					<div class="well">
						<h4>Cart Summary</h4>
						<hr>
						<table class="table">
							<tr>
								<td>Total Qty</td>
								<td>{{basket.totalQty}}</td>
							</tr>
							<tr>
								<td>Sub Total</td>
								<td>{{basket.subTotal | number_format}} IDR</td>
							</tr>
						</table>
						<form action="{{path_for('order.index')}}" method="POST">
							<button class="btn btn-default">Check Out</button>
							{{csrf.field | raw}}
						</form>
					</div>
				{% endif %}
			</div>
		</div>
	</section>
{% endblock %}